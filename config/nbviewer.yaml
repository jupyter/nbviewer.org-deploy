replicas: 3

image: jupyter/nbviewer:efc7e78

memcached:
  image:
    # bitnami is retiring public images, find something else
    repository: bitnamilegacy/memcached
  args:
    - memcached
    - -vv
    - -u memcached
    - -p
    - "11211"
    - "-m"
    - "1600"
  resources:
    requests:
      cpu: 100m
      memory: 2Gi
    limits:
      cpu: 500m
      memory: 2Gi

nbviewer:
  extraArgs:
  - '--cache-expiry-min=3600'
  - '--cache-expiry-max=14400'
  - "--content-security-policy=connect-src *" # https://github.com/jupyter/nbviewer/issues/797
  - '--jupyter-js-widgets-version=2.1' # https://github.com/jupyter/nbviewer/issues/818
  - '--jupyter-widgets-html-manager-version=0.15' # https://github.com/jupyter/nbviewer/issues/818
  - >-
    --NBViewer.extra_head_html=
    <script defer data-domain="nbviewer.org" src="https://plausible.io/js/script.file-downloads.outbound-links.js"></script>
    <script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>

statuspage:
  enabled: true
  pageId: fzcq6v7wcg65
  metricId: rfcg9djxtg6n
